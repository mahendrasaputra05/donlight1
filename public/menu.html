<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Donlight - Menu</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <link rel="stylesheet" href="css/menu.css">
</head>

<body>
<div class="app-bg">

<!-- NAVBAR -->
<header class="nav-bar">
  <div class="container nav-inner">
    <div class="nav-left">
      <span class="brand">Donlight</span>
    </div>
    <nav class="nav-right">
      <a class="nav-icon"><i class="bi bi-house"></i></a>
      <a class="nav-icon active"><i class="bi bi-list"></i> Menu</a>
      <a href="cart.html" class="nav-icon">
        <i class="bi bi-cart"></i>
        <span id="cart-badge" class="cart-badge">0</span>
      </a>
      <a class="nav-icon"><i class="bi bi-person"></i></a>
    </nav>
  </div>
</header>

<main class="container menu-page">

<h1 class="menu-title">Our Menu</h1>
<p class="menu-subtitle">
  Discover our delicious selection of donuts, drinks, and bundles
</p>

<!-- SEARCH -->
<div class="search-box">
  <i class="bi bi-search"></i>
  <input id="searchInput" type="text" placeholder="Search for donuts, drinks, or bundles...">
</div>

<!-- FILTER -->
<div class="filter-row">
  <button class="filter-btn active" data-filter="all">All Products</button>
  <button class="filter-btn" data-filter="donuts">Donuts</button>
  <button class="filter-btn" data-filter="drinks">Drinks</button>
  <button class="filter-btn" data-filter="bundles">Bundles</button>
</div>

<!-- PRODUCTS -->
<div class="product-grid">

  <div class="product-card" data-category="donuts" data-name="Pink Sprinkle Delight" data-price="18000">
    <img src="https://images.pexels.com/photos/3026804/pexels-photo-3026804.jpeg">
    <h3>Pink Sprinkle Delight</h3>
    <p>Classic pink frosted donut with colorful sprinkles</p>
    <button class="add-cart-btn">Add to Cart</button>
  </div>

  <div class="product-card" data-category="drinks" data-name="Matcha Latte" data-price="15000">
    <img src="https://images.pexels.com/photos/3026804/pexels-photo-3026804.jpeg">
    <h3>Matcha Latte</h3>
    <p>Matchanya enak bener</p>
    <button class="add-cart-btn">Add to Cart</button>
  </div>

  <div class="product-card" data-category="donuts" data-name="donuts cokocip" data-price="12000">
    <img src="https://images.pexels.com/photos/3026804/pexels-photo-3026804.jpeg">
    <h3>Donuts Cokocip</h3>
    <p>Classic donut with chocolate chips</p>
    <button class="add-cart-btn">Add to Cart</button>
  </div>

  <div class="product-card" data-category="bundles" data-name="donat pink dan matcha latte" data-price="25000">
    <img src="https://images.pexels.com/photos/3026804/pexels-photo-3026804.jpeg">
    <h3>Donut + Matcha Latte</h3>
    <p>Matcha sama donatnya oke dah pokoknya</p>
    <button class="add-cart-btn">Add to Cart</button>
  </div>

</div>
</main>
</div>

<!-- ================= SCRIPT AREA (WAJIB DI SINI) ================= -->

<!-- FILTER + SEARCH -->
<script>
const filterBtns = document.querySelectorAll(".filter-btn");
const products = document.querySelectorAll(".product-card");
const searchInput = document.getElementById("searchInput");

filterBtns.forEach(btn => {
  btn.addEventListener("click", () => {
    filterBtns.forEach(b => b.classList.remove("active"));
    btn.classList.add("active");

    const filter = btn.dataset.filter;
    products.forEach(product => {
      product.style.display =
        filter === "all" || product.dataset.category === filter
          ? "block"
          : "none";
    });
  });
});

searchInput.addEventListener("keyup", () => {
  const keyword = searchInput.value.toLowerCase();
  products.forEach(product => {
    product.style.display = product.dataset.name.toLowerCase().includes(keyword)
      ? "block"
      : "none";
  });
});
</script>

<!-- ADD TO CART (QTY FIX) -->
<script>
const cartBtns = document.querySelectorAll(".add-cart-btn");

cartBtns.forEach(btn => {
  btn.addEventListener("click", () => {
    const card = btn.closest(".product-card");
    const name = card.dataset.name;
    const price = parseInt(card.dataset.price);

    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    const item = cart.find(i => i.name === name);

    if (item) {
      item.qty += 1;
    } else {
      cart.push({ name, price, qty: 1 });
    }

    localStorage.setItem("cart", JSON.stringify(cart));
    updateCartBadge();

    btn.innerText = "Added âœ“";
    setTimeout(() => btn.innerText = "Add to Cart", 700);
  });
});
</script>

<!-- CART BADGE -->
<script>
function updateCartBadge() {
  const badge = document.getElementById("cart-badge");
  if (!badge) return;

  const cart = JSON.parse(localStorage.getItem("cart")) || [];
  const total = cart.reduce((sum, i) => sum + i.qty, 0);

  badge.innerText = total;
  badge.style.display = total > 0 ? "flex" : "none";
}
updateCartBadge();
</script>

<!-- LOGOUT -->
<script>
if (localStorage.getItem("isLogin")) {
  const profileIcon = document.querySelector(".bi-person")?.parentElement;
  if (profileIcon) {
    profileIcon.onclick = () => {
      localStorage.removeItem("isLogin");
      location.href = "login.html";
    };
  }
}
</script>

</body>
</html>
